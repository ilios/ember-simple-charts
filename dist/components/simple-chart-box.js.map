{"version":3,"file":"simple-chart-box.js","sources":["../../src/components/simple-chart-box.gjs"],"sourcesContent":["import Component from '@glimmer/component';\nimport { tracked } from '@glimmer/tracking';\nimport { assert } from '@ember/debug';\nimport { select } from 'd3-selection';\nimport { scaleSequential } from 'd3-scale';\nimport { interpolateSinebow } from 'd3-scale-chromatic';\nimport { modifier } from 'ember-modifier';\n\nexport default class SimpleChartBox extends Component {\n  @tracked loading = true;\n\n  paint = modifier(\n    (element, [data, isIcon, isClickable, hover, leave, onClick]) => {\n      this.loading = true;\n      assert(\n        'Box Data contains \"allData\"',\n        Object.keys(data).includes('allData'),\n      );\n      assert(\n        'Box Data contains \"boxData\"',\n        Object.keys(data).includes('boxData'),\n      );\n      const svg = select(element);\n      const values = data.allData.map((o) => o.data);\n      const color = scaleSequential(interpolateSinebow).domain([\n        0,\n        Math.max(...values),\n      ]);\n\n      svg.selectAll('.box').remove();\n      const box = svg.append('g').attr('class', 'box');\n\n      const rect = box\n        .selectAll('rect')\n        .data([data.boxData])\n        .enter()\n        .append('rect')\n        .attr('width', '100%')\n        .attr('height', '100%')\n        .attr('x', 0)\n        .attr('y', 0)\n        .attr('fill', (d) => color(d.data));\n\n      if (!isIcon) {\n        const handleHover = ({ target }) => {\n          const { label, data, meta } = select(target).datum();\n          const rects = svg.selectAll('rect');\n          const selected = rects.filter((rectData) => rectData.data === data);\n          hover({ label, data, meta }, selected.node());\n        };\n        rect.on('mouseenter', handleHover);\n        rect.on('mouseleave', leave);\n\n        if (isClickable) {\n          rect.on('click', ({ target }) => {\n            const data = select(target).datum();\n            onClick(data);\n          });\n          rect.style('cursor', 'pointer');\n        }\n      }\n      this.loading = false;\n    },\n  );\n  <template>\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      class=\"simple-chart-box{{if this.loading ' loading' ' loaded'}}\"\n      height={{@containerHeight}}\n      width={{@containerWidth}}\n      {{this.paint @data @isIcon @isClickable @hover @leave @onClick}}\n      ...attributes\n    ></svg>\n  </template>\n}\n"],"names":["SimpleChartBox","Component","g","prototype","tracked","i","paint","modifier","element","data","isIcon","isClickable","hover","leave","onClick","loading","assert","Object","keys","includes","svg","select","values","allData","map","o","color","scaleSequential","interpolateSinebow","domain","Math","max","selectAll","remove","box","append","attr","rect","boxData","enter","d","handleHover","target","label","meta","datum","rects","selected","filter","rectData","node","on","style","setComponentTemplate","precompileTemplate","strictMode"],"mappings":"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"}