{"version":3,"file":"timeout.js","sources":["../../src/utils/timeout.js"],"sourcesContent":["import {\n  registerDestructor,\n  isDestroying,\n  isDestroyed,\n} from '@ember/destroyable';\nimport { assert } from '@ember/debug';\n\n/**\n * Replacemnet for ember-concurrency timeout\n * We tie into the ember internals and resolve this promise anytime the calling component\n * gets destroyed.\n */\nexport default function timeout(timeoutMs, owner) {\n  assert(\n    'Passed timeout value must be an integer',\n    Number.isInteger(timeoutMs),\n  );\n  assert('The passed owner must be an object', typeof owner === 'object');\n\n  return new Promise((resolve) => {\n    if (isDestroying(owner) || isDestroyed(owner)) {\n      resolve(); //resolve imediatly if we're already destroyed\n    }\n\n    const id = setTimeout(() => {\n      resolve();\n    }, timeoutMs);\n\n    registerDestructor(owner, () => {\n      clearTimeout(id);\n      Promise.resolve().then(() => {\n        resolve();\n      });\n    });\n  });\n}\n"],"names":["timeout","timeoutMs","owner","assert","Number","isInteger","Promise","resolve","isDestroying","isDestroyed","id","setTimeout","registerDestructor","clearTimeout","then"],"mappings":";;;AAOA;AACA;AACA;AACA;AACA;AACe,SAASA,OAAOA,CAACC,SAAS,EAAEC,KAAK,EAAE;EAChDC,MAAM,CACJ,yCAAyC,EACzCC,MAAM,CAACC,SAAS,CAACJ,SAAS,CAC5B,CAAC;AACDE,EAAAA,MAAM,CAAC,oCAAoC,EAAE,OAAOD,KAAK,KAAK,QAAQ,CAAC;AAEvE,EAAA,OAAO,IAAII,OAAO,CAAEC,OAAO,IAAK;IAC9B,IAAIC,YAAY,CAACN,KAAK,CAAC,IAAIO,WAAW,CAACP,KAAK,CAAC,EAAE;MAC7CK,OAAO,EAAE,CAAC;AACZ,IAAA;AAEA,IAAA,MAAMG,EAAE,GAAGC,UAAU,CAAC,MAAM;AAC1BJ,MAAAA,OAAO,EAAE;IACX,CAAC,EAAEN,SAAS,CAAC;IAEbW,kBAAkB,CAACV,KAAK,EAAE,MAAM;MAC9BW,YAAY,CAACH,EAAE,CAAC;AAChBJ,MAAAA,OAAO,CAACC,OAAO,EAAE,CAACO,IAAI,CAAC,MAAM;AAC3BP,QAAAA,OAAO,EAAE;AACX,MAAA,CAAC,CAAC;AACJ,IAAA,CAAC,CAAC;AACJ,EAAA,CAAC,CAAC;AACJ;;;;"}